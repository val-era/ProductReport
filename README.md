Добро пожаловать в программу для создания отчетов по товару и работой с фотографиями товаров.


<h1>Краткие обозначения:</h1>

  **БД** – База данных с данными

  **Абсолютный путь** – путь к файлу или папке в формате _C:\\User\\...\\ название файла}.{расширение файла}_

  Абсолютный путь можно получить, нажав правой кнопкой мыши по файлу и выбрав блок свойства. Абсолютный путь в данном способе получается, как _Расположение файла + имя файла с     
  расширением_

  **.xlsx** – расширение файла Microsoft Excel

  **Загрузочный файл** – файл .xlsx в определенном формате, заданном блоком инструкции

  **Директория** – место хранение определенного файла или программы

  **Полное название файла** – название файла с расширением (Test.xlsx и т. п.)



<h1>Оглавление:</h1>

  - Общая информация
  - Запуск программы
  - Функционал программы
  - Отчеты Best Sellers и Sales Analyses
  - Загрузка фотографий в файл .xlsx
  - Загрузка фотографий товаров в БД
  - Замена существующих фотографий в базе данных
  - Сохранение фотографий товаров из базы данных в папку по списку
  - Проверка фотографий по списку в папке и удаление лишних фотографий
  - Удаление фотографий из базы данных по списку
  - Получение фотографий в БД
  - Комментарии



<h1>1. Общая информация</h1>

Программа собрана для еженедельной глубокой аналитики товара и его продаж в компании. Получив ссылку на скачивание файла .exe необходимо сохранить его в отдельную папку. При возникновении ошибки “Непроверенный источник выпуска программы” необходимо Игнорировать и запустить программу. Данная ошибка возникает, т. к. проект самописный.

В папке с файлом программы будет находиться база данных – файл (_ProductReportDB.db_). **Не удаляйте данный файл**, это БД, где будут храниться фотографии товаров для отчетности. Данный файл может занимать много места, зависит от кол-во фотографий, загруженных в БД. БД создается автоматически при отработке определенных функций.

Обратите внимание, для выгрузки фотографий, отчетности и других функций, необходимо заполнить БД фотографиями. Не меняйте имя файла БД, не удаляйте его и без осознания работы с БД не вытаскивайте информацию сторонними программами.



<h1>2. Запуск программы</h1>

Запуск программы происходит, через консоль. При двойном щелчке открывается консоль, в которой происходит дальнейшая работа с программой.


    Добро пожаловать в программу для создания отчетов, подробную инструкцию вы можете изучить
    на <https://github.com/val-era/ProductReport>
    Выберите действие, которое хотите выполнить. Для выбора введите цифру ниже после \[+\]
    Работа с отчетами:
    Для формирования отчетов Best Sellers и Sales Analyses введите 1
    Для загрузки фотографий в выбранный вами файл введите 2

    Работа с фотографиями:
    Для записи фотографий в базу данных введите 3
    Для замены существующих фотографий в базе данных введите 4
    Для сохранения фотографий в папку из вашего списка введите 5
    Для проверки соответствия фотографий в папке, списка в эксель и удаления лишних фото из папки введите 6
    Для удаления фотографий из базы данных по списку введите 7
    Для получения листа текущих фотографий в БД введите 8

    [+]


Выше вывод консоли, при запуске программы. Данные пункты соответствуют оглавлению в начале инструкции. Для дальнейшей работы необходимо ввести цифру без лишних символов и пробелов после \[+\]



<h1>3. Функционал программы</h1>

Основной функционал программы – составление еженедельных отчетов по товару и работа с фотографиями, необходимыми для составления отчета.

 - Отчеты Best Sellers и Sales Analyses - 1
 - Загрузка фотографий в файл .xlsx - 2
 - Загрузка фотографий товаров в БД - 3
 - Замена существующих фотографий в базе данных - 4
 - Сохранение фотографий товаров из базы данных в папку по списку - 5
 - Проверка фотографий по списку в папке и удаление лишних фотографий - 6
 - Удаление фотографий из базы данных по списку - 7
 - Получение фотографий присутствующих в БД - 8



<h1>4. Отчеты Best Sellers и Sales Analyses</h1>

Составление двух отчетов (Топ продаж с разбивкой по магазинам и категориям и полные отчеты по товару в магазинах). _Для запуска используется цифра 1._

На вход принимается абсолютный путь к загрузочному файлу .xlsx Если загрузочный файл находится в директории файла, то на вход можно записать в консоль полное название файла.

**Загрузочный файл должен быть в формате ниже. Названия колонок должны быть как в инструкции ниже.** 70% данных колонок выгружается с [автоматического отчета по аналитике остатков](https://github.com/val-era/StockGrade2).

Имена колонок загрузочного файла. **Обратите внимание, что в некоторых именах колонок присутствуют \[\]. Это означает строгое соответствие значений ячеек в колонке с данными в этих скобках. Как пример в колонке категория могут быть только значения _APP, FTW, ACC_**:

  - **Магазин** - Наименование магазина
  - **Артикул** - Артикул товара
  - **Наименование** - Можно оставить пустым (Наименование товара по 1с)
  - **Модель ANTA** – Название модели
  - **Тип продукта** - Группа продукта (Куртка и тп)
  - **Количество** - Кол-во штучек на остатке на артикул
  - **Категория** - Категория товара в формате **\[APP, FTW, ACC\]**
  - **Сезон** - Сезон товара
  - **SKU** - **\[1\]** используется для подсчета артикулов
  - **RRP, RRP Amount** - Цена и суммма стока в деньгах, необходима для усовершенствования отчета и дальнейших метрик, в данный момент не задействована.
  - **Grade** **\[A, B, C\]** - Грейд остатков товара
  - **Пол** - **\[MEN, WOMEN, UNISEX, KIDS\]**
  - **Коллекция** - Коллекция продукта
  - **Актуальный заказ** - Нахождение артикула в матрице магазина **\[Актуально, Не актуально\]**
  - **Сумма со скидкой** - Сумма продаж артикула со скидкой
  - **Кол-во продаж** - Сумма проданных штук

![image](https://github.com/user-attachments/assets/ed6477c5-f902-4878-ac31-76c3bac076b2)


В результате загрузки данного загрузочного файла формируются два отчета и сохраняются в папке с программой. Имена отчетов **_Best Sellers Report.xlsx_** и **_Sales Analyses Report.xlsx_**



<h1>5. Загрузка фотографий в файл .xlsx</h1>

Основной функционал программы – сопоставление программой артикула из ячеек в колонке A:A и вставка фотографии по артикулу в ячейки B:B. _Для запуска используется цифра 2._

На вход принимается абсолютный путь к загрузочному файлу .xlsx

**Загрузочный файл должен быть в формате A:A – артикулы товара в ячейках, B:B – пустые ячейки под фотографии**, остальные колонки могут быть заполнены произвольными данными или быть пустыми.

После обработки файла происходит сохранение нового файла с фотографиями, где к имени файла добавляется NEW. Файл сохраняется в директории, где находится загрузочный файл.



<h1>6. Загрузка фотографий товаров в БД</h1>

Основной функционал программы – загрузка фотографий товаров в БД для дальнейшей работы с ними и формирования отчетов. _Для запуска используется цифра 3._

**На вход принимается абсолютный путь к папке с фотографиями. Фотографии должны быть в форматах .jpg, .png, .jpeg. Имена фотографий должны быть равны артикулу в фото, т.е. Имя файла – артикул товара.**

При первой загрузке фотографий необходимо создать файл с именем No-photo, которое будет подтягиваться к артикулам при отсутствии фотографий. Фото может быть любым, по вашему желанию.

При первой загрузке фотографий необходимо создать файл с именем Information. В этом фото содержатся основные метрики отчета, получите его у разработчика.



<h1>7. Замена существующих фотографий в базе данных</h1>

Основной функционал программы – замена фотографий в базе данных с удалением старых версий и загрузкой новых. _Для запуска используется цифра 4._

**На вход принимается абсолютный путь к папке с фотографиями. Фотографии должны быть в форматах .jpg, .png, .jpeg. Имена фотографий должны быть равны артикулу в фото, т.е. Имя файла – артикул товара.**

**8\. Сохранение фотографий товаров из базы данных в папку по списку**

Основной функционал программы – сохранение фотографий товаров из БД согласно списку Эксель в папку. _Для запуска используется цифра 5._

На вход принимаются два значения:

   
    Введите путь к файлу эксель с артикулами для создания фото, Артикулы должны быть в колонке A:A
    [+]
     

После \[+\] вводится абсолютный путь к загрузочному файлу .xlsx. **Загрузочный файл должен быть в формате A:A – артикулы товара в ячейках.**

    
    Введите путь к папке где должны быть фото
    {+}
    

После {+} вводится абсолютный путь к папке, где должны располагаться фотографии.

В директории с фотографиями может сохраниться файл _Артикула без фото.xlsx_ – Файл с артикулами на которые не было найдено фото в БД.



<h1>9. Проверка фотографий по списку в папке и удаление лишних фотографий</h1>

Основной функционал программы – проверка фотографий в папке по файлу .xlsx и удаление лишних фотографий. _Для запуска используется цифра 6._

Обратите внимание, функция тестовая, лучше разбивать папку с множеством фотографий, на несколько, иначе компьютер может не успевать обновлять данные и программа может вылететь.

На вход принимаются два значения:

    
    Введите путь к файлу эксель с артикулами для создания фото, Артикулы должны быть в колонке A:A
    [+]
     

После \[+\] вводится абсолютный путь к загрузочному файлу .xlsx. **Загрузочный файл должен быть в формате A:A – артикулы товара в ячейках.**

    
    Введите путь к папке где должны быть фото
    {+}
    

После {+} вводится абсолютный путь к папке, где должны располагаться фотографии.

В директории с фотографиями, после обработки остаются только фото из списка.



<h1>10. Удаление фотографий из базы данных по списку</h1>

Основной функционал программы – удаление фотографий из БД по файлу .xlsx. _Для запуска используется цифра 7._

    
    Введите путь к файлу эксель с артикулами для удаления. Артикулы должны быть в колонке A:A
    [+]
     

После \[+\] вводится абсолютный путь к загрузочному файлу .xlsx для удаление фото из БД. **Загрузочный файл должен быть в формате A:A – артикулы товара в ячейках.**



<h1>11. Получение фотографий присутствующих в БД</h1>

Основной функционал программы – получение списка с фотографиями в БД. _Для запуска используется цифра 8._

На выходе в директорию с программой сохраняется файл с названием _Фото из БД.xlsx_



<h1>12. Комментарии</h1>

При возникновении ошибок свяжитесь с разработчиком, сохраните загрузочный файл и версию программы.

Val_era
